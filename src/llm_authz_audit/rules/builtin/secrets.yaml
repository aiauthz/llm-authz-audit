rules:
  - id: SEC001
    title: "Hardcoded OpenAI API key"
    severity: critical
    pattern: '(?:sk-(?:proj-)?[a-zA-Z0-9]{20,})'
    file_types: ["*.py", "*.yaml", "*.yml", "*.json", "*.toml", "*.env", "*.cfg", "*.ini"]
    suppress_if: ['os\.environ', 'os\.getenv', 'getenv\(', '# nosec', '# noqa']
    owasp_llm: "LLM06"
    remediation: "Use environment variables: os.environ['OPENAI_API_KEY']"
    description: "Detected a hardcoded OpenAI API key. This can lead to unauthorized API usage and billing."
    analyzer: "SecretsAnalyzer"

  - id: SEC002
    title: "Hardcoded Anthropic API key"
    severity: critical
    pattern: 'sk-ant-[a-zA-Z0-9\-]{20,}'
    file_types: ["*.py", "*.yaml", "*.yml", "*.json", "*.toml", "*.env", "*.cfg", "*.ini"]
    suppress_if: ['os\.environ', 'os\.getenv', 'getenv\(', '# nosec', '# noqa']
    owasp_llm: "LLM06"
    remediation: "Use environment variables: os.environ['ANTHROPIC_API_KEY']"
    description: "Detected a hardcoded Anthropic API key."
    analyzer: "SecretsAnalyzer"

  - id: SEC003
    title: "Hardcoded HuggingFace API token"
    severity: critical
    pattern: 'hf_[a-zA-Z0-9]{20,}'
    file_types: ["*.py", "*.yaml", "*.yml", "*.json", "*.toml", "*.env", "*.cfg", "*.ini"]
    suppress_if: ['os\.environ', 'os\.getenv', 'getenv\(', '# nosec', '# noqa']
    owasp_llm: "LLM06"
    remediation: "Use environment variables: os.environ['HF_TOKEN']"
    description: "Detected a hardcoded HuggingFace API token."
    analyzer: "SecretsAnalyzer"

  - id: SEC004
    title: "Hardcoded AWS access key"
    severity: critical
    pattern: 'AKIA[0-9A-Z]{16}'
    file_types: ["*.py", "*.yaml", "*.yml", "*.json", "*.toml", "*.env", "*.cfg", "*.ini"]
    suppress_if: ['os\.environ', 'os\.getenv', 'getenv\(', '# nosec', '# noqa']
    owasp_llm: "LLM06"
    remediation: "Use AWS credential providers or environment variables."
    description: "Detected a hardcoded AWS access key ID."
    analyzer: "SecretsAnalyzer"

  - id: SEC005
    title: "Hardcoded generic API key or secret"
    severity: high
    pattern: '(?i)(?:api[_-]?key|api[_-]?secret|secret[_-]?key|auth[_-]?token)\s*[=:]\s*["\x27][a-zA-Z0-9\-_]{16,}["\x27]'
    file_types: ["*.py", "*.yaml", "*.yml", "*.json", "*.toml", "*.env", "*.cfg", "*.ini"]
    suppress_if: ['os\.environ', 'os\.getenv', 'getenv\(', '# nosec', '# noqa', 'placeholder', 'example', 'your-', 'xxx', 'TODO']
    owasp_llm: "LLM06"
    remediation: "Store secrets in environment variables or a secrets manager."
    description: "Detected what appears to be a hardcoded API key or secret value."
    analyzer: "SecretsAnalyzer"

  - id: SEC006
    title: "Hardcoded password"
    severity: high
    pattern: '(?i)(?:password|passwd|pwd)\s*[=:]\s*["\x27][^\s"'']{8,}["\x27]'
    file_types: ["*.py", "*.yaml", "*.yml", "*.json", "*.toml", "*.env", "*.cfg", "*.ini"]
    suppress_if: ['os\.environ', 'os\.getenv', 'getenv\(', '# nosec', '# noqa', 'placeholder', 'example', 'your-', 'xxx', 'TODO', 'input\(']
    owasp_llm: "LLM06"
    remediation: "Never hardcode passwords. Use environment variables or a secrets manager."
    description: "Detected a hardcoded password value."
    analyzer: "SecretsAnalyzer"
